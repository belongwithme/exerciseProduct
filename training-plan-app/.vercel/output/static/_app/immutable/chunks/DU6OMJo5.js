import"./CWj6FrbW.js";import{i as it}from"./DvY-oIkD.js";import{G as qa,q as Aa,b as c,p as vt,at as nt,o as gt,f,d as r,s as d,r as t,g as a,m as L,t as b,j as g,e as Ea,c as ct,i as D,u as s,n as _t,y as J,aZ as Ma,v as Pa}from"./OdQOizuy.js";import{i as u}from"./C8SgvbjV.js";import{e as za,i as Va}from"./CZywz5Xw.js";import{s as E}from"./BZ6qwgwY.js";import{l as Ja,s as Oa,p as X}from"./iScJf1SD.js";import{X as pt}from"./C5W0R8hy.js";import{s as Sa}from"./AOTWZyJM.js";import{I as Ga}from"./hDZfQjOx.js";function yt(M,x){const j=Ja(x,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const P=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];Ga(M,Oa({name:"arrow-left"},()=>j,{get iconNode(){return P},children:(k,z)=>{var w=qa(),o=Aa(w);Sa(o,x,"default",{}),c(k,w)},$$slots:{default:!0}}))}function ft(M,x){const j=Ja(x,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.525.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const P=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];Ga(M,Oa({name:"arrow-right"},()=>j,{get iconNode(){return P},children:(k,z)=>{var w=qa(),o=Aa(w);Sa(o,x,"default",{}),c(k,w)},$$slots:{default:!0}}))}var xt=f('<div class="p-6"><div class="p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"><p class="text-red-800 dark:text-red-200 text-sm"> </p></div></div>'),mt=f('<div class="flex justify-center items-center py-12"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div> <span class="ml-3 text-gray-600 dark:text-gray-300">加载版本内容...</span></div>'),bt=f('<div class="text-sm text-gray-500 dark:text-gray-400 mt-1"> </div>'),ut=f('<div><div class="font-medium text-gray-800 dark:text-gray-200"> </div> <div class="text-sm text-gray-600 dark:text-gray-400 mt-1"> <!></div> <!></div>'),ht=f('<div class="space-y-2"></div>'),kt=f('<p class="text-gray-500 dark:text-gray-400 italic">无训练动作</p>'),wt=f('<div class="text-sm text-gray-500 dark:text-gray-400 mt-1"> </div>'),$t=f('<div><div class="font-medium text-gray-800 dark:text-gray-200"> </div> <div class="text-sm text-gray-600 dark:text-gray-400 mt-1"> <!></div> <!></div>'),Nt=f('<div class="space-y-2"></div>'),jt=f('<p class="text-gray-500 dark:text-gray-400 italic">无训练动作</p>'),Ct=f('<div class="h-full overflow-y-auto"><div class="grid grid-cols-2 gap-6 p-6"><div class="space-y-4"><div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg"><h3 class="text-lg font-semibold text-blue-800 dark:text-blue-200 flex items-center"><!> </h3></div> <div class="space-y-3"><h4 class="font-semibold text-gray-700 dark:text-gray-300">基本信息</h4> <div><label class="text-sm font-medium text-gray-600 dark:text-gray-400">计划名称:</label> <p class="text-gray-800 dark:text-gray-200"> </p></div> <div><label class="text-sm font-medium text-gray-600 dark:text-gray-400">计划描述:</label> <p class="text-gray-800 dark:text-gray-200"> </p></div></div> <div class="space-y-3"><h4 class="font-semibold text-gray-700 dark:text-gray-300">训练动作</h4> <!></div></div> <div class="space-y-4"><div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg"><h3 class="text-lg font-semibold text-green-800 dark:text-green-200 flex items-center"><!> </h3></div> <div class="space-y-3"><h4 class="font-semibold text-gray-700 dark:text-gray-300">基本信息</h4> <div><label class="text-sm font-medium text-gray-600 dark:text-gray-400">计划名称:</label> <p class="text-gray-800 dark:text-gray-200"> </p></div> <div><label class="text-sm font-medium text-gray-600 dark:text-gray-400">计划描述:</label> <p class="text-gray-800 dark:text-gray-200"> </p></div></div> <div class="space-y-3"><h4 class="font-semibold text-gray-700 dark:text-gray-300">训练动作</h4> <!></div></div></div> <div class="border-t border-gray-200 dark:border-gray-700 p-6"><div class="bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4"><h4 class="font-semibold text-yellow-800 dark:text-yellow-200 mb-2">差异说明</h4> <p class="text-sm text-yellow-700 dark:text-yellow-300">标记为黄色背景的区域表示两个版本间存在差异。未标记的区域表示内容相同。</p></div></div></div>'),It=f('<div class="fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4"><div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-7xl max-h-[90vh] flex flex-col"><div class="p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><div><h2 class="text-xl font-bold text-gray-800 dark:text-white">版本对比</h2> <p class="text-sm text-gray-600 dark:text-gray-400"> </p></div> <button class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"><!></button></div> <div class="flex-1 overflow-hidden"><!></div> <div class="p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end space-x-4"><button class="px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors">关闭</button></div></div></div>');function St(M,x){vt(x,!1);let j=X(x,"planId",8),P=X(x,"planName",8,""),k=X(x,"version1Number",8),z=X(x,"version2Number",8);const w=nt();let o=L(null),i=L(null),Z=L(!0),O=L("");async function _a(v){try{const n=await fetch(`/api/plans/${j()}/versions/${v}`);if(n.ok)return await n.json();{const I=await n.json();throw new Error(I.error||`获取版本 ${v} 失败`)}}catch(n){throw console.error(`获取版本 ${v} 内容时发生错误:`,n),n}}async function Ha(){D(Z,!0),D(O,"");try{const[v,n]=await Promise.all([_a(k()),_a(z())]);D(o,v),D(i,n)}catch(v){D(O,v instanceof Error?v.message:"加载版本内容失败")}finally{D(Z,!1)}}function La(v,n){return JSON.stringify(v)!==JSON.stringify(n)}function C(v,n){return La(v,n)?"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-700":""}function pa(){w("close")}gt(()=>{Ha()}),it();var B=It(),ya=r(B),F=r(ya),K=r(F),fa=d(r(K),2),Xa=r(fa);t(fa),t(K);var Q=d(K,2),Za=r(Q);pt(Za,{class:"w-5 h-5"}),t(Q),t(F);var R=d(F,2),Ba=r(R);{var Fa=v=>{var n=xt(),I=r(n),S=r(I),h=r(S,!0);t(S),t(I),t(n),b(()=>g(h,a(O))),c(v,n)},Ka=(v,n)=>{{var I=h=>{var T=mt();c(h,T)},S=(h,T)=>{{var Ra=U=>{var W=Ct(),ma=r(W),Y=r(ma),aa=r(Y),ba=r(aa),ua=r(ba);yt(ua,{class:"w-5 h-5 mr-2"});var Ta=d(ua);t(ba),t(aa);var ta=d(aa,2),G=d(r(ta),2),ha=d(r(G),2),Ua=r(ha,!0);t(ha),t(G);var ra=d(G,2),ka=d(r(ra),2),Wa=r(ka,!0);t(ka),t(ra),t(ta);var wa=d(ta,2),Ya=d(r(wa),2);{var at=_=>{var p=ht();za(p,5,()=>(a(o),s(()=>a(o).exercises)),Va,(V,e,oa)=>{var m=ut();const q=J(()=>(a(i),s(()=>{var l;return(l=a(i).exercises)==null?void 0:l[oa]})));var $=r(m),la=r($);t($);var N=d($,2),A=r(N),ia=d(A);{var va=l=>{var y=Pa();b(()=>g(y,`@ ${a(e),s(()=>a(e).target_weight_kg)??""}kg`)),c(l,y)};u(ia,l=>{a(e),s(()=>a(e).target_weight_kg)&&l(va)})}t(N);var na=d(N,2);{var ga=l=>{var y=bt(),ca=r(y);t(y),b(()=>g(ca,`备注: ${a(e),s(()=>a(e).notes)??""}`)),c(l,y)};u(na,l=>{a(e),s(()=>a(e).notes)&&l(ga)})}t(m),b(l=>{E(m,1,`p-3 border rounded ${l??""}`),g(la,`动作 ID: ${a(e),s(()=>a(e).exercise_id)??""}`),g(A,`${a(e),s(()=>a(e).target_sets)??""} 组 × ${a(e),s(()=>a(e).target_reps)??""} 次 `)},[()=>(a(e),Ma(a(q)),s(()=>C(a(e),a(q))))],J),c(V,m)}),t(p),c(_,p)},tt=_=>{var p=kt();c(_,p)};u(Ya,_=>{a(o),s(()=>a(o).exercises&&a(o).exercises.length>0)?_(at):_(tt,!1)})}t(wa),t(Y);var $a=d(Y,2),ea=r($a),Na=r(ea),ja=r(Na);ft(ja,{class:"w-5 h-5 mr-2"});var rt=d(ja);t(Na),t(ea);var sa=d(ea,2),H=d(r(sa),2),Ca=d(r(H),2),et=r(Ca,!0);t(Ca),t(H);var da=d(H,2),Ia=d(r(da),2),st=r(Ia,!0);t(Ia),t(da),t(sa);var Da=d(sa,2),dt=d(r(Da),2);{var ot=_=>{var p=Nt();za(p,5,()=>(a(i),s(()=>a(i).exercises)),Va,(V,e,oa)=>{var m=$t();const q=J(()=>(a(o),s(()=>{var l;return(l=a(o).exercises)==null?void 0:l[oa]})));var $=r(m),la=r($);t($);var N=d($,2),A=r(N),ia=d(A);{var va=l=>{var y=Pa();b(()=>g(y,`@ ${a(e),s(()=>a(e).target_weight_kg)??""}kg`)),c(l,y)};u(ia,l=>{a(e),s(()=>a(e).target_weight_kg)&&l(va)})}t(N);var na=d(N,2);{var ga=l=>{var y=wt(),ca=r(y);t(y),b(()=>g(ca,`备注: ${a(e),s(()=>a(e).notes)??""}`)),c(l,y)};u(na,l=>{a(e),s(()=>a(e).notes)&&l(ga)})}t(m),b(l=>{E(m,1,`p-3 border rounded ${l??""}`),g(la,`动作 ID: ${a(e),s(()=>a(e).exercise_id)??""}`),g(A,`${a(e),s(()=>a(e).target_sets)??""} 组 × ${a(e),s(()=>a(e).target_reps)??""} 次 `)},[()=>(a(e),Ma(a(q)),s(()=>C(a(e),a(q))))],J),c(V,m)}),t(p),c(_,p)},lt=_=>{var p=jt();c(_,p)};u(dt,_=>{a(i),s(()=>a(i).exercises&&a(i).exercises.length>0)?_(ot):_(lt,!1)})}t(Da),t($a),t(ma),_t(2),t(W),b((_,p,V,e)=>{g(Ta,` 版本 ${k()??""}`),E(G,1,`p-3 rounded ${_??""}`),g(Ua,(a(o),s(()=>a(o).plan_name||"未设置"))),E(ra,1,`p-3 rounded ${p??""}`),g(Wa,(a(o),s(()=>a(o).plan_description||"未设置"))),g(rt,` 版本 ${z()??""}`),E(H,1,`p-3 rounded ${V??""}`),g(et,(a(i),s(()=>a(i).plan_name||"未设置"))),E(da,1,`p-3 rounded ${e??""}`),g(st,(a(i),s(()=>a(i).plan_description||"未设置")))},[()=>(a(o),a(i),s(()=>C(a(o).plan_name,a(i).plan_name))),()=>(a(o),a(i),s(()=>C(a(o).plan_description,a(i).plan_description))),()=>(a(i),a(o),s(()=>C(a(i).plan_name,a(o).plan_name))),()=>(a(i),a(o),s(()=>C(a(i).plan_description,a(o).plan_description)))],J),c(U,W)};u(h,U=>{a(o)&&a(i)&&U(Ra)},T)}};u(v,h=>{a(Z)?h(I):h(S,!1)},n)}};u(Ba,v=>{a(O)?v(Fa):v(Ka,!1)})}t(R);var xa=d(R,2),Qa=r(xa);t(xa),t(ya),t(B),b(()=>g(Xa,`${(P()||`计划 #${j()}`)??""} - 版本 ${k()??""} vs 版本 ${z()??""}`)),Ea("click",Q,pa),Ea("click",Qa,pa),c(M,B),ct()}export{St as default};
