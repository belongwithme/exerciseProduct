# 个人资料管理功能说明

## 概述

个人资料管理功能已完成，用户可以录入和修改身高、体重、力量数据、摸高数据，系统会自动计算需提升的弹跳高度。

## 功能特性

### ✅ 已完成功能

1. **创建个人资料表单**
   - 基本信息：用户名、全名、年龄、性别
   - 身体数据：身高、体重（自动计算BMI）
   - 弹跳数据：站立摸高、最大摸高（自动计算垂直跳跃）
   - 力量数据：卧推、深蹲、硬拉
   - 目标设定：目标摸高（自动计算需提升高度）

2. **实现数据验证**
   - 前端表单验证
   - 数值范围检查
   - 逻辑关系验证（如最大摸高必须大于站立摸高）

3. **添加数据更新功能**
   - 支持数据的增加、修改
   - 自动保存到Supabase数据库
   - 实时错误处理和成功提示

4. **计算需提升的弹跳高度**
   - 自动计算垂直跳跃能力
   - 计算达到目标需要提升的高度
   - 实时显示计算结果

## 页面结构

### 路由
- `/profile` - 个人资料管理页面

### 组件
- `ProfileForm.svelte` - 个人资料表单组件
- `/routes/profile/+page.svelte` - 个人资料管理页面

## 数据库结构

### profiles表字段
```sql
- id (string) - 用户ID，关联auth.users
- username (string) - 用户名
- full_name (string, optional) - 全名
- age (number, optional) - 年龄
- gender (string, optional) - 性别
- height_cm (number, optional) - 身高(cm)
- weight_kg (number, optional) - 体重(kg)
- standing_reach_cm (number, optional) - 站立摸高(cm)
- max_touch_height_cm (number, optional) - 最大摸高(cm)
- bench_press_kg (number, optional) - 卧推重量(kg)
- squat_kg (number, optional) - 深蹲重量(kg)
- deadlift_kg (number, optional) - 硬拉重量(kg)
- target_touch_height_cm (number, optional) - 目标摸高(cm)
- updated_at (string, optional) - 更新时间
```

## 计算功能

### 自动计算项目
1. **BMI计算**：体重(kg) ÷ 身高(m)²
2. **垂直跳跃**：最大摸高 - 站立摸高
3. **目标提升量**：目标摸高 - 当前最大摸高

### 数据验证规则
- 身高：100-250cm
- 体重：30-200kg
- 年龄：10-100岁
- 站立摸高：≥150cm
- 最大摸高：>站立摸高
- 目标摸高：>当前最大摸高
- 力量数据：≥0

## 使用流程

1. **访问页面**：登录后点击主页的"个人资料"按钮
2. **填写信息**：按照表单分区填写各项数据
3. **实时计算**：系统自动计算BMI、垂直跳跃等数据
4. **保存资料**：点击"保存资料"按钮提交数据
5. **查看结果**：查看计算出的需提升弹跳高度

## 技术实现

### 前端技术
- **SvelteKit** - 页面框架
- **TypeScript** - 类型安全
- **Tailwind CSS** - 样式设计
- **响应式设计** - 支持移动端

### 后端技术
- **Supabase** - 数据库和认证
- **RLS策略** - 数据安全
- **实时数据同步** - 自动更新

### 数据流
1. 用户输入 → 前端验证 → 提交到Supabase
2. Supabase存储 → 返回结果 → 更新前端状态
3. 实时计算 → 显示计算结果

## 下一步开发

根据todolist.md，下一个阶段是：

### 📊 第四阶段：数据分析与可视化
- 弹跳能力分析图表（甜甜圈图）
- 力量结构评估图表（雷达图）
- Chart.js集成

## 注意事项

1. **数据安全**：所有用户数据通过RLS策略保护
2. **输入验证**：前端和后端双重验证
3. **用户体验**：实时反馈和错误提示
4. **响应式设计**：支持各种设备尺寸

---

*功能完成于2025年1月27日，执行人：AI助手* 